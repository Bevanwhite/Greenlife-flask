{% from "helper/modal_helper.html.j2" import delete_modal, render_pagination %}
{% extends "layout.html.j2" %} 
{% block content %}
<h1 class="mt-2"> {{ title }}</h1>
<div class="d-flex justify-content-end">
    {% if current_user.role.name == 'admin' or current_user.role.name == 'therapist'%}
    <a class="btn  btn-outline-secondary" 
        href="{{url_for('new_service')}}">
        New service
    </a>
    {% endif %}
</div>
{% if services.items | length > 0%}
<table class="table mt-2">
    <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">Description</th>
            <th scope="col">Date posted</th>
            <th scope="col">Service Type</th>
            <th scope="col">Created By</th>
            <th scope="col" style="width: 15%"></th>
        </tr>
    </thead>
    <tbody>
        {% for service in services.items %}
        <tr>
            <th scope="row">{{ service.id }}</th>
            <td>{{ service.name }}</td>
            <td>{{ service.description }}</td>
            <td>{{ service.date_created.strftime("%B %d, %Y") }}</td>
            <td>{{ service.service_type.name }}</td>
            <td><a href="{{url_for('user_services', username=service.user.username)}}">{{ service.user.full_name }}</a></td>
            <td>
                <a class="btn btn-outline-secondary" 
                    href="{{url_for('view_service', service_id=service.id)}}">
                    <i class="bi bi-eye-fill "></i>
                </a>
                {% if service.user_service == current_user or current_user.role.name == 'admin' %}
                <a class="btn btn-outline-secondary" 
                    href="{{url_for('update_service', service_id=service.id)}}">
                    <i class="bi bi-pencil-fill"></i>
                </a>
                <button class="btn btn-outline-secondary" 
                    data-bs-toggle="modal" 
                    data-bs-target="#deleteModal-{{service.id}}">
                    <i class="bi bi-trash3-fill "></i>
                </button>
                {{ delete_modal(service) }}
                {% endif %}
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>
{% endif %}
<div class="pt-1 text-center">
{{ render_pagination(services, 'service') }}
</div>
{% endblock content %}